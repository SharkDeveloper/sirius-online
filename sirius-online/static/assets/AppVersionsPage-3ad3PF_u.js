import{av as F,a as $,ci as H,b as W,c as b,i as Q,co as M,r as m,P as X,o as c,e as B,cp as Y,w as h,g as l,n as C,aX as P,ag as E,h as e,cq as j,l as L,F as q,f as d,cr as z,m as k,cs as J,ct as K,cu as Z,bu as ee}from"./app-X261GMLD.js";import{u as ae,a as te}from"./settings.services-CtvtW5n1.js";const le={key:0,class:"mt-16"},oe={class:"column gap-4 mt-16"},ie={class:"text-h2"},ne={__name:"AppUpdateDeviceDialog",props:{modelValue:{type:Boolean,required:!0},target:{type:String,required:!0}},emits:["update:modelValue"],setup(s,{emit:t}){const a=$(),{captureInterface:x,releaseInterface:n}=H(),o=W(),f=b(()=>o.getters.isUpdating),I=i=>o.commit("setDeviceUpdating",i),v=Q("$toast"),N=s,w=t,S={firmware:["hex","chp"],web:["bin"]},A=b(()=>({web:a.value.SETTINGS.VERSIONS.UPDATE_DIALOG.uploadBIN,firmware:a.value.SETTINGS.VERSIONS.UPDATE_DIALOG.uploadHEXorCHP})),V=b(()=>({web:a.value.SETTINGS.VERSIONS.BUTTON.updateWebClient,firmware:a.value.SETTINGS.VERSIONS.BUTTON.updateFirmwareGlobal})),T=b({get(){return N.modelValue},set(i){w("update:modelValue",i)}}),{exportConfig:O,downloadConfig:G,loading:R}=M(),u=m(null);X(T,i=>{i||(u.value=null)});function y(i){if(!i&&f.value){v.add(a.value.SETTINGS.VERSIONS.TOAST.UPDATE.IN_PROGRESS);return}T.value=i}const _=m(!0);async function U(){try{if(I(!0),x({isShowSpinner:!1,isHandleCloseWindow:!0}),N.target==="web")await ae(u.value),v.add(a.value.SETTINGS.VERSIONS.TOAST.UPDATE.WEB_SUCCESS);else{if(_.value){const i=await O(),g=K("sirius_config");await G(g,i)}await te(u.value),v.add(a.value.SETTINGS.VERSIONS.TOAST.UPDATE.FIRMWARE_SUCCESS)}T.value=!1,setTimeout(()=>{window.location.reload()},0)}catch(i){console.error(i),v.add(a.value.SETTINGS.VERSIONS.TOAST.UPDATE.FAILED)}finally{n(),I(!1)}}const p=b(()=>f.value||R.value);return(i,g)=>(c(),B(e(J),{show:T.value,"onUpdate:show":y,file:u.value,"onUpdate:file":g[2]||(g[2]=D=>u.value=D),title:V.value[s.target],description:A.value[s.target],"file-types":S[s.target]},Y({default:h(()=>[l(j,{file:u.value},null,8,["file"]),f.value?(c(),L("div",le,E(e(a).SETTINGS.VERSIONS.UPDATE_DIALOG.progress),1)):s.target==="firmware"?(c(),L(q,{key:1},[d("div",oe,[d("div",ie,E(e(a).GENERAL.LABEL.attention)+"!",1),P(" "+E(e(a).SETTINGS.VERSIONS.UPDATE_DIALOG.warn),1)]),l(z,{modelValue:_.value,"onUpdate:modelValue":g[0]||(g[0]=D=>_.value=D),label:e(a).SETTINGS.VERSIONS.BUTTON.saveConfig,class:"dialog-toggle","left-label":""},null,8,["modelValue","label"])],64)):k("",!0)]),_:2},[u.value?{name:"footer",fn:h(()=>[l(C,{disable:p.value,onClick:g[1]||(g[1]=D=>u.value=null),class:"fill-input","data-testid":"dialog-reset-btn"},{default:h(()=>[P(E(e(a).GENERAL.BUTTON.reset),1)]),_:1},8,["disable"]),l(C,{loading:p.value,onClick:U,color:"primary","data-testid":"dialog-update-btn"},{default:h(()=>[P(E(e(a).GENERAL.BUTTON.update),1)]),_:1},8,["loading"])]),key:"0"}:void 0]),1032,["show","file","title","description","file-types"]))}},se=F(ne,[["__scopeId","data-v-f9f3aa76"]]),ue={class:"item"},re={class:"item__label"},de={key:1,class:"item__value"},ce={__name:"AppVersionsPageItem",props:{label:{type:[String],required:!0},value:{type:[String,null]},iLoading:{type:[Boolean],required:!0}},setup(s){return(t,a)=>(c(),L("div",ue,[d("span",re,E(s.label)+": ",1),s.iLoading?(c(),B(Z,{key:0,width:"70px",height:"16px"})):s.value?(c(),L("span",de,E(s.value),1)):k("",!0)]))}},r=F(ce,[["__scopeId","data-v-2eb6be59"]]),ve={class:"config-form__body"},Se={class:"config-form__title text-h1"},ge={class:"versions__layout"},Ee={class:"versions__body"},Te={class:"versions__body"},_e={class:"action-buttons"},pe={__name:"AppVersionsPage",setup(s){const t=$(),a=W(),x=()=>a.dispatch("setting/fetchAndSetVersionsData"),n=b(()=>a.getters["setting/VERSIONS_LIST"]),o=m(!0);ee(async()=>{await x(),o.value=!1});const f="2.01.024-undefined",I=m("web"),v=m(!1);function N(w){I.value=w,v.value=!0}return(w,S)=>{var A,V,T,O,G,R,u,y,_,U;return c(),L(q,null,[d("div",ve,[d("div",Se,E(e(t).ROUTER.SETTINGS.versions),1),d("div",ge,[d("div",Ee,[(A=n.value)!=null&&A.serial_number?(c(),B(r,{key:0,value:(V=n.value)==null?void 0:V.serial_number,iLoading:o.value,label:e(t).SETTINGS.VERSIONS.LABEL.serial_number},null,8,["value","iLoading","label"])):k("",!0),(T=n.value)!=null&&T.hw_version?(c(),B(r,{key:1,value:(O=n.value)==null?void 0:O.hw_version,iLoading:o.value,label:e(t).SETTINGS.VERSIONS.LABEL.hw_version},null,8,["value","iLoading","label"])):k("",!0),l(r,{value:(G=n.value)==null?void 0:G.boot_version,iLoading:o.value,label:e(t).SETTINGS.VERSIONS.LABEL.boot_version},null,8,["value","iLoading","label"]),l(r,{value:e(f),iLoading:o.value,label:e(t).SETTINGS.VERSIONS.LABEL.web_client_version},null,8,["value","iLoading","label"])]),d("div",Te,[l(r,{value:(R=n.value)==null?void 0:R.sw_version,iLoading:o.value,label:e(t).SETTINGS.VERSIONS.LABEL.sw_version},null,8,["value","iLoading","label"]),l(r,{value:(u=n.value)==null?void 0:u.db_config_version,iLoading:o.value,label:e(t).SETTINGS.VERSIONS.LABEL.db_config_version},null,8,["value","iLoading","label"]),l(r,{value:(y=n.value)==null?void 0:y.db_state_version,iLoading:o.value,label:e(t).SETTINGS.VERSIONS.LABEL.db_state_version},null,8,["value","iLoading","label"]),l(r,{value:(_=n.value)==null?void 0:_.event_log_version,iLoading:o.value,label:e(t).SETTINGS.VERSIONS.LABEL.event_log_version},null,8,["value","iLoading","label"]),l(r,{value:(U=n.value)==null?void 0:U.web_server_version,iLoading:o.value,label:e(t).SETTINGS.VERSIONS.LABEL.web_server_version},null,8,["value","iLoading","label"])])]),d("div",_e,[l(C,{label:e(t).SETTINGS.VERSIONS.BUTTON.updateWebClient,onClick:S[0]||(S[0]=p=>N("web")),class:"text-button bg-back","data-testid":"orion-key-encryption-btn","text-color":"primary"},null,8,["label"]),l(C,{label:e(t).SETTINGS.VERSIONS.BUTTON.updateFirmwareGlobal,onClick:S[1]||(S[1]=p=>N("firmware")),class:"text-button bg-back","data-testid":"orion-key-encryption-btn","text-color":"primary"},null,8,["label"])])]),l(e(se),{modelValue:v.value,"onUpdate:modelValue":S[2]||(S[2]=p=>v.value=p),target:I.value},null,8,["modelValue","target"])],64)}}},Ie=F(pe,[["__scopeId","data-v-618a455c"]]);export{Ie as default};
