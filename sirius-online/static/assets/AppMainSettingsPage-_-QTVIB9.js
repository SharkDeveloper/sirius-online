import{av as U,o as f,l as D,f as m,ag as k,aw as oe,c7 as ne,c8 as se,c9 as ie,c as r,ca as G,ah as re,cb as de,cc as ue,e as x,w as b,cd as me,aX as be,m as O,u as pe,a as ce,b as _e,i as ge,bu as fe,O as Se,bh as h,r as I,ce as Ne,P as q,h as e,g as n,j as S,k as Te,v,Q as p,a3 as F,Z as c,n as E,bD as Ie,p as ve,cf as Ee,F as Ae,M as xe}from"./app-X261GMLD.js";import{A as Ve}from"./AppKeyEncryptionDialog-Bk20_hHA.js";import{_ as Le,a as _}from"./AppMacInput-Cg7qsIbn.js";import{u as ye,g as Me}from"./useConfigForm-Dwead9lM.js";import{g as Ge}from"./settings.services-CtvtW5n1.js";import{A as g}from"./AppInputNumberWithCheckbox-C-TLkeux.js";import{_ as B}from"./AppInputNumber-pcfWNGSA.js";const Be={class:"settings-card"},Oe={class:"settings-card__title"},Ue={class:"settings-card__body"},ke={__name:"AppSettingsFormCard",props:{title:{type:String,required:!0}},setup(i){const u=i;return(o,d)=>(f(),D("div",Be,[m("span",Oe,k(u.title),1),m("div",Ue,[oe(o.$slots,"default",{},void 0,!0)])]))}},A=U(ke,[["__scopeId","data-v-40a9b7c0"]]),Ce=ne({name:"QAvatar",props:{...se,fontSize:String,color:String,textColor:String,icon:String,square:Boolean,rounded:Boolean},setup(i,{slots:u}){const o=ie(i),d=r(()=>"q-avatar"+(i.color?` bg-${i.color}`:"")+(i.textColor?` text-${i.textColor} q-chip--colored`:"")+(i.square===!0?" q-avatar--square":i.rounded===!0?" rounded-borders":"")),N=r(()=>i.fontSize?{fontSize:i.fontSize}:null);return()=>{const V=i.icon!==void 0?[G(re,{name:i.icon})]:void 0;return G("div",{class:d.value,style:o.value},[G("div",{class:"q-avatar__content row flex-center overflow-hidden",style:N.value},de(u.default,V))])}}}),ze={__name:"AppHint",props:{tooltip:{type:String,default:""},color:{type:String,default:"dark-blue"},size:{type:String,default:"md"},icon:{type:String,default:ue},textColor:{type:String,default:"white"},offset:{type:Array,default:()=>[0,0]},anchor:{type:String,default:"bottom middle"},self:{type:String,default:"top middle"}},setup(i){return(u,o)=>(f(),x(Ce,{class:"b-hint",size:i.size,color:i.color,"text-color":i.textColor,icon:i.icon},{default:b(()=>[i.tooltip?(f(),x(me,{key:0,offset:i.offset,anchor:i.anchor,self:i.self,class:"bg-dark text-white q-pa-sm text-base","max-width":"300px"},{default:b(()=>[be(k(i.tooltip),1)]),_:1},8,["offset","anchor","self"])):O("",!0)]),_:1},8,["size","color","text-color","icon"]))}},Re=U(ze,[["__scopeId","data-v-4d872f30"]]),we={class:"config-form__body"},he={class:"config-form__title text-h1"},qe={class:"config-form__controller"},Fe={class:"config-form__settings"},De={class:"row gap-8 items-center"},$e={class:"config-form__buttons"},je={__name:"AppMainSettingsPage",setup(i){const{t:u}=pe(),o=ce(),d=_e(),N=ge("$toast");fe(()=>{d.dispatch("config/fetchAndSetElementList",{types:["zone","zone_group","controller"]}).then(()=>{w(),L.value=!0}).catch(s=>{console.error(s)})});const V=r(()=>Object.values(d.getters["zone/ZONE_LIST"])),$=r(()=>Object.values(d.getters["zone_group/ZONE_GROUP_LIST"])),C=r(()=>d.getters["setting/IS_DISABLE_SYNC_BUTTON"]),z=r(()=>{const s=[];return s.push({label:o.value.CONFIGURATION.GENERAL.notSetParentheses,value:Se}),s.concat($.value.map(t=>({label:t.fullName,value:t.index+h,number:t.number+h})).sort((t,l)=>t.number-l.number)).concat(V.value.map(t=>({label:t.fullName,value:t.index,number:t.number})).sort((t,l)=>t.number-l.number))}),j=r(()=>d.getters["setting/SETTINGS_LIST"]),R=r(()=>d.getters["controller/CONTROLLER_LIST"]),{form:a,formRef:Q,onSave:P,onReset:w,isSaving:T}=ye({saveFn:te,resetFn:ee}),L=I(!1),y=I(!1),Z=I(!1),K=r(()=>Object.entries(Ne).map(([s,t])=>({label:t,value:Number(s)})).sort((s,t)=>s.value-t.value)),X=r(()=>[{label:o.value.SETTINGS.MAIN.disabled,value:!1},{label:o.value.SETTINGS.MAIN.activated,value:!0}]),H=r(()=>Object.entries(o.value.SETTINGS.MAIN.UI_LANGUAGE).map(([s,t])=>({label:t,value:Number(s)})).sort((s,t)=>s.label.localeCompare(t.label))),J=r(()=>Object.entries(o.value.SETTINGS.MAIN.SOUND_MODE).map(([s,t])=>({label:t,value:Number(s)})));function Y(s){s.value.settings={};for(const l of Object.values(j.value))l.index===0&&(s.value.settings={...l})}function W(s){s.value.controller={};for(const t of Object.values(R.value))t.index===xe&&(s.value.controller={...t})}function ee({form:s}){s.value={},Y(s),W(s)}async function te(){T.value=!0;const s={data:JSON.parse(JSON.stringify(a.value.controller)),type:"controller"},t={data:JSON.parse(JSON.stringify(a.value.settings)),type:"setting"};return s.data.ip=t.data.ip,await d.dispatch("config/saveElement",{elementList:[s,t]}),!0}async function le(){try{y.value=!0,await Ge(),N.add(o.value.SETTINGS.MAIN.TOAST.SYNC_TIME.SUCCESS)}catch(s){console.error(s),N.add(o.value.SETTINGS.MAIN.TOAST.SYNC_TIME.FAILED)}finally{y.value=!1}}const M=I(!1),ae=r(()=>Me(Object.values(R.value),"contact_id",a.value.controller.index).map(Number));return q(()=>a.value.settings.fire_generate_enabled,s=>{s||(a.value.settings.fire_generate_timeout=0)},{immediate:!0}),q(()=>a.value.settings.fire2_generate_count,s=>{s||(a.value.settings.fire2_generate_timeout=0)}),(s,t)=>(f(),D(Ae,null,[L.value?(f(),x(ve,{key:0,onSubmit:e(P),onReset:e(w),ref_key:"formRef",ref:Q,class:"config-form"},{default:b(()=>[m("div",we,[m("div",he,k(e(o).ROUTER.SETTINGS.main),1),m("div",qe,[n(S,{modelValue:e(a).controller.name,"onUpdate:modelValue":t[0]||(t[0]=l=>e(a).controller.name=l),modelModifiers:{trim:!0},label:e(o).GENERAL.LABEL.name,rules:e(Te),"data-testid":"name-input",class:"b-field"},null,8,["modelValue","label","rules"]),n(Le,{modelValue:e(a).controller.mac,"onUpdate:modelValue":t[1]||(t[1]=l=>e(a).controller.mac=l),label:e(o).SETTINGS.MAIN.LABEL.mac,class:"b-field","data-testid":"mac-input",disable:""},null,8,["modelValue","label"]),n(S,{modelValue:e(a).controller.contact_id,"onUpdate:modelValue":t[2]||(t[2]=l=>e(a).controller.contact_id=l),modelModifiers:{number:!0},rules:[l=>e(v).coerce.number().integer().min(1).max(999).notIn(ae.value).validate(l)],hint:e(u)("error.range",{min:1,max:999}),"data-testid":"contact-id-input",label:"Contact ID",class:"b-field",type:"number",max:"999",min:"1"},null,8,["modelValue","rules","hint"])]),m("div",Fe,[n(A,{title:e(o).SETTINGS.MAIN.operationLogic},{default:b(()=>[n(p,{modelValue:e(a).settings.notify_zone_index,"onUpdate:modelValue":t[3]||(t[3]=l=>e(a).settings.notify_zone_index=l),options:z.value,label:e(o).SETTINGS.MAIN.LABEL.notify_zone_index,"data-testid":"notify-zone-index-select","emit-value":"","map-options":"",class:"b-field"},null,8,["modelValue","options","label"]),n(p,{modelValue:e(a).settings.aroute_zone_index,"onUpdate:modelValue":t[4]||(t[4]=l=>e(a).settings.aroute_zone_index=l),options:z.value,label:e(o).SETTINGS.MAIN.LABEL.aroute_zone_index,"data-testid":"aroute-zone-index-select","emit-value":"","map-options":"",class:"b-field"},null,8,["modelValue","options","label"]),n(p,{modelValue:e(a).settings.sound_mode,"onUpdate:modelValue":t[5]||(t[5]=l=>e(a).settings.sound_mode=l),options:J.value,label:e(o).SETTINGS.MAIN.LABEL.sound_mode,"data-testid":"sound-mode-select","emit-value":"","map-options":"",class:"b-field"},null,8,["modelValue","options","label"]),n(S,{modelValue:e(a).settings.delay_step,"onUpdate:modelValue":t[6]||(t[6]=l=>e(a).settings.delay_step=l),modelModifiers:{number:!0},label:e(o).SETTINGS.MAIN.LABEL.delay_step+" *",rules:[l=>e(v).coerce.number().required().integer().min(10).max(120).validate(l)],hint:e(u)("error.range",{min:10,max:120}),"data-testid":"delay-step-input",type:"number",max:"120",min:"10",class:"b-field"},null,8,["modelValue","label","rules","hint"]),n(S,{modelValue:e(a).settings.pin_code_maxlen,"onUpdate:modelValue":t[7]||(t[7]=l=>e(a).settings.pin_code_maxlen=l),modelModifiers:{number:!0},label:e(o).SETTINGS.MAIN.LABEL.pin_code_maxlen+" *",rules:[l=>e(v).coerce.number().required().integer().min(1).max(12).validate(l)],hint:e(u)("error.range",{min:1,max:12}),"data-testid":"pin-code-maxlen-input",type:"number",max:"12",min:"1",class:"b-field"},null,8,["modelValue","label","rules","hint"]),n(p,{modelValue:e(a).settings.web_server_enabled,"onUpdate:modelValue":t[8]||(t[8]=l=>e(a).settings.web_server_enabled=l),options:X.value,label:e(o).SETTINGS.MAIN.LABEL.web_server_enabled,"data-testid":"web-server-enabled-select","emit-value":"","map-options":"",class:"b-field"},null,8,["modelValue","options","label"]),n(F,{modelValue:e(a).settings.fire_generate_enabled,"onUpdate:modelValue":t[9]||(t[9]=l=>e(a).settings.fire_generate_enabled=l),label:e(o).SETTINGS.MAIN.LABEL.fire_generate_enabled,class:"b-checkbox","left-label":"","data-testid":"fire-generate-enabled-checkbox"},null,8,["modelValue","label"]),n(g,{modelValue:e(a).settings.fire_generate_timeout,"onUpdate:modelValue":t[10]||(t[10]=l=>e(a).settings.fire_generate_timeout=l),modelModifiers:{number:!0},label:e(o).SETTINGS.MAIN.LABEL.fire_generate_timeout,min:1,max:255,"true-value":0,disable:!e(a).settings.fire_generate_enabled,"checkbox-label":e(o).CONFIGURATION.GENERAL.infinityTime,"data-testid":"fire-generate-timeout",required:""},null,8,["modelValue","label","disable","checkbox-label"]),n(g,{modelValue:e(a).settings.fire2_generate_count,"onUpdate:modelValue":t[11]||(t[11]=l=>e(a).settings.fire2_generate_count=l),modelModifiers:{number:!0},label:e(o).SETTINGS.MAIN.LABEL.fire2_generate_count,min:2,max:255,"true-value":0,"checkbox-label":e(o).SETTINGS.MAIN.LABEL.static_fire2_generate_count,"data-testid":"fire2-generate-count",required:""},null,8,["modelValue","label","checkbox-label"]),n(g,{modelValue:e(a).settings.fire2_generate_timeout,"onUpdate:modelValue":t[12]||(t[12]=l=>e(a).settings.fire2_generate_timeout=l),modelModifiers:{number:!0},label:e(o).SETTINGS.MAIN.LABEL.fire2_generate_timeout,min:1,max:255,"true-value":0,"checkbox-label":e(o).CONFIGURATION.GENERAL.infinityTime,disable:!e(a).settings.fire2_generate_count,"data-testid":"fire2-generate-timeout",required:""},null,8,["modelValue","label","checkbox-label","disable"]),n(p,{modelValue:e(a).settings.ui_language,"onUpdate:modelValue":t[13]||(t[13]=l=>e(a).settings.ui_language=l),options:H.value,label:e(o).SETTINGS.MAIN.LABEL.ui_language,"data-testid":"ui-language-select","emit-value":"","map-options":"",class:"b-field"},null,8,["modelValue","options","label"])]),_:1},8,["title"]),n(A,{title:e(o).SETTINGS.MAIN.networkSettings},{default:b(()=>[n(F,{label:e(o).SETTINGS.MAIN.LABEL.use_dhcp,modelValue:e(a).settings.use_dhcp,"onUpdate:modelValue":t[14]||(t[14]=l=>e(a).settings.use_dhcp=l),"data-testid":"use-dhcp-checkbox",class:"b-checkbox","left-label":""},null,8,["label","modelValue"]),n(_,{modelValue:e(a).settings.ip,"onUpdate:modelValue":t[15]||(t[15]=l=>e(a).settings.ip=l),label:e(o).SETTINGS.MAIN.LABEL.ip+" *",disable:e(a).settings.use_dhcp,class:"b-field","data-testid":"ip-input"},null,8,["modelValue","label","disable"]),n(_,{modelValue:e(a).settings.subnet_mask,"onUpdate:modelValue":t[16]||(t[16]=l=>e(a).settings.subnet_mask=l),label:e(o).SETTINGS.MAIN.LABEL.subnet_mask+" *",disable:e(a).settings.use_dhcp,class:"b-field","data-testid":"subnet-mask-input"},null,8,["modelValue","label","disable"]),n(_,{modelValue:e(a).settings.default_gateway,"onUpdate:modelValue":t[17]||(t[17]=l=>e(a).settings.default_gateway=l),label:e(o).SETTINGS.MAIN.LABEL.default_gateway+" *",disable:e(a).settings.use_dhcp,class:"b-field","data-testid":"gateway-input"},null,8,["modelValue","label","disable"]),n(_,{modelValue:e(a).settings.primary_dns,"onUpdate:modelValue":t[18]||(t[18]=l=>e(a).settings.primary_dns=l),label:e(o).SETTINGS.MAIN.LABEL.primary_dns,disable:e(a).settings.use_dhcp,class:"b-field","data-testid":"primary-dns-input",nullable:""},null,8,["modelValue","label","disable"]),n(_,{modelValue:e(a).settings.secondary_dns,"onUpdate:modelValue":t[19]||(t[19]=l=>e(a).settings.secondary_dns=l),label:e(o).SETTINGS.MAIN.LABEL.secondary_dns,disable:e(a).settings.use_dhcp,class:"b-field","data-testid":"secondary-dns-input",nullable:""},null,8,["modelValue","label","disable"])]),_:1},8,["title"]),n(A,{title:e(o).SETTINGS.MAIN.orion},{default:b(()=>[n(B,{modelValue:e(a).settings.orion_rx_udp_port,"onUpdate:modelValue":t[20]||(t[20]=l=>e(a).settings.orion_rx_udp_port=l),modelModifiers:{number:!0},label:e(o).SETTINGS.MAIN.LABEL.orion_rx_udp_port,max:65535,min:1,"data-testid":"orion-rx-udp-port-input",required:""},null,8,["modelValue","label"]),n(g,{modelValue:e(a).settings.orion_tx_udp_port,"onUpdate:modelValue":t[21]||(t[21]=l=>e(a).settings.orion_tx_udp_port=l),modelModifiers:{number:!0},label:e(o).SETTINGS.MAIN.LABEL.orion_tx_udp_port,"checkbox-label":e(o).SETTINGS.MAIN.LABEL.dynamic_orion_tx_udp_port,max:65535,min:1,"true-value":0,"data-testid":"orion-tx-udp-port",required:""},null,8,["modelValue","label","checkbox-label"]),n(g,{modelValue:e(a).settings.orion_tx_udp_port_period,"onUpdate:modelValue":t[22]||(t[22]=l=>e(a).settings.orion_tx_udp_port_period=l),min:1,max:240,"true-value":0,step:e(c),multiple:e(c),label:e(o).SETTINGS.MAIN.LABEL.orion_tx_udp_port_period,"checkbox-label":e(o).SETTINGS.MAIN.LABEL.static_orion_tx_udp_port_period,"data-testid":"orion-tx-udp-port-period",required:""},null,8,["modelValue","step","multiple","label","checkbox-label"]),n(B,{modelValue:e(a).settings.orion_connection_timeout,"onUpdate:modelValue":t[23]||(t[23]=l=>e(a).settings.orion_connection_timeout=l),min:8,max:4800,step:e(c),multiple:e(c),label:e(o).SETTINGS.MAIN.LABEL.orion_connection_timeout,"data-testid":"orion-connection-timeout-input",required:""},null,8,["modelValue","step","multiple","label"]),n(B,{modelValue:e(a).settings.orion_resend_timeout,"onUpdate:modelValue":t[24]||(t[24]=l=>e(a).settings.orion_resend_timeout=l),min:8,max:240,step:e(c),multiple:e(c),label:e(o).SETTINGS.MAIN.LABEL.orion_resend_timeout,"data-testid":"orion-resend-timeout-input",required:""},null,8,["modelValue","step","multiple","label"]),n(E,{loading:Z.value,label:e(o).SETTINGS.MAIN.BUTTON.changeKeyEncryption,onClick:t[25]||(t[25]=l=>M.value=!0),class:"text-button bg-back","data-testid":"orion-key-encryption-btn","text-color":"primary"},null,8,["loading","label"]),n(_,{modelValue:e(a).settings.orion_remote_ip,"onUpdate:modelValue":t[26]||(t[26]=l=>e(a).settings.orion_remote_ip=l),label:e(o).SETTINGS.MAIN.LABEL.orion_remote_ip,disable:e(a).settings.use_dhcp,class:"b-field","data-testid":"orion-remote-ip-input",nullable:""},null,8,["modelValue","label","disable"]),n(g,{modelValue:e(a).settings.orion_remote_rx_port,"onUpdate:modelValue":t[27]||(t[27]=l=>e(a).settings.orion_remote_rx_port=l),modelModifiers:{number:!0},label:e(o).SETTINGS.MAIN.LABEL.orion_remote_rx_port,"checkbox-label":e(o).SETTINGS.MAIN.LABEL.static_orion_remote_rx_port,min:1,max:65535,"true-value":0,required:"","data-testid":"orion-remote-rx-port"},null,8,["modelValue","label","checkbox-label"])]),_:1},8,["title"]),n(A,{title:e(o).SETTINGS.MAIN.syncTime},{default:b(()=>[n(p,{modelValue:e(a).settings.time_zone,"onUpdate:modelValue":t[28]||(t[28]=l=>e(a).settings.time_zone=l),options:K.value,label:e(o).SETTINGS.MAIN.LABEL.time_zone,"data-testid":"time-zone-select","emit-value":"","map-options":"",class:"b-field"},null,8,["modelValue","options","label"]),n(S,{modelValue:e(a).settings.sntp_server_name,"onUpdate:modelValue":t[29]||(t[29]=l=>e(a).settings.sntp_server_name=l),modelModifiers:{trim:!0},label:e(o).SETTINGS.MAIN.LABEL.sntp_server_name,rules:[l=>e(v).string().maxLength(31).regex(e(Ie)).validate(l)],"data-testid":"sntp-server-name-input",maxlength:"31",class:"b-field"},null,8,["modelValue","label","rules"]),m("div",De,[n(E,{loading:y.value,label:e(o).SETTINGS.MAIN.BUTTON.syncTime,disable:C.value,onClick:le,class:"col text-button bg-back","data-testid":"sync-time-btn","text-color":"primary"},null,8,["loading","label","disable"]),C.value?(f(),x(Re,{key:0,self:"top left",offset:[0,35],tooltip:e(u)("hint.syncTime")},null,8,["tooltip"])):O("",!0)])]),_:1},8,["title"])])]),m("div",$e,[n(E,{label:e(o).GENERAL.BUTTON.reset,disable:e(T),class:"text-button fill-input",type:"reset","data-testid":"form-reset-btn"},null,8,["label","disable"]),n(E,{loading:e(T),label:e(o).GENERAL.BUTTON.save,disable:e(T),class:"text-button","data-testid":"form-save-btn",color:"positive",type:"submit"},null,8,["loading","label","disable"])])]),_:1},8,["onSubmit","onReset"])):O("",!0),n(Ve,{modelValue:M.value,"onUpdate:modelValue":t[30]||(t[30]=l=>M.value=l),type:"setting"},null,8,["modelValue"]),n(Ee,{showing:!L.value,color:"primary",size:"xl"},null,8,["showing"])],64))}},Ye=U(je,[["__scopeId","data-v-612effaa"]]);export{Ye as default};
